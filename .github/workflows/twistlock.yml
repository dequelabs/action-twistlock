on: [push]

jobs:
  twistlock_scan:
    runs-on: ubuntu-latest
    name: Build and scan
    steps:
      - uses: actions/checkout@v2

      # Build the image we're going to scan.
      - run: docker build -t myapp:test ./test

      # Run the Twistlock action.
      - uses: dequelabs/action-twistlock@use-api-token
        with:
          tl-token: ${{ secrets.TWISTLOCK_TOKEN }}
          tl-console-url: https://us-west1.cloud.twistlock.com/us-4-161056371
          docker-image: myapp:test
